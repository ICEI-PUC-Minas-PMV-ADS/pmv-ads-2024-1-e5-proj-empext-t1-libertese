@model Libertese.ViewModels.PrecificacaoCreateViewModel
@using Microsoft.AspNetCore.Mvc.TagHelpers


<div class="px-4 sm:px-6 lg:px-8 py-8 w-full max-w-9xl mx-auto">
    <div class="mb-1">
        <div class="flex items-center justify-between">
            <h4 class="text-xl md:text-xl text-slate-800 dark:text-slate-100 font-bold">Rateio</h4>
            <button id="calcularRateio" class="btn bg-orange-800 hover:bg-orange-900 text-white rounded-lg w-28">
                <ion-icon name="calculator-outline" class="nav__icon"></ion-icon>
                <span class="hidden xs:block ml-2">Calcular</span>
            </button>
        </div>
    </div>
    <div class="border-t border-slate-200 dark:border-slate-700">
        <div class="space-y-8 mt-5">
            <div>
                <div class="bg-white dark:bg-slate-800 shadow-lg rounded-sm border border-slate-200 dark:border-slate-700 mb-0">
                    <header class="px-5 py-4">
                        <h2 class="font-semibold text-slate-800 dark:text-slate-100">Rateios <span name="totalDeRateios" id="totalDeRateios" class="text-slate-400 dark:text-slate-500 font-medium">@Model.Produtos.Count()</span></h2>
                    </header>
                    <div x-data="{ modalDeletarOpen: false, modalVisualizarOpen: false, tableIndex: 0 }">
                        <div class="overflow-x-auto">
                            <table id="rateiossTable" class="table-auto w-full dark:text-slate-300">
                                <thead class="text-xs font-semibold uppercase text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-900/20 border-t border-b border-slate-200 dark:border-slate-700">
                                    <tr>
                                        <th class="px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap">
                                            <div class="font-semibold text-left">Código</div>
                                        </th>
                                        <th class="px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap">
                                            <div class="font-semibold text-left">Nome</div>
                                        </th>
                                        <th class="px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap">
                                            <div class="font-semibold text-left">Custo Produção</div>
                                        </th>
                                        <th class="px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap">
                                            <div class="font-semibold text-left">Rateio</div>
                                        </th>
                                        <th class="px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap">
                                            <div class="font-semibold text-left">Custo Total</div>
                                        </th>
                                        <th class="px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap">
                                            <div class="font-semibold text-left">Custo Unitário</div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody class="text-sm divide-y divide-slate-200 dark:divide-slate-700">
                                    @for (var i = 0; i < Model.Rateios.Count; i++)
                                    {
                                        <tr>
                                            <td class="px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"><div class="font-medium text-sky-500">@Model.Rateios[i].Id</div></td>
                                            <td class="px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"><div class="truncate max-w-80ch font-medium text-slate-800 dark:text-slate-100">@Model.Rateios[i].Nome</div></td>
                                            <td class="px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"><div class="font-medium text-slate-800 dark:text-slate-100">R$ @Model.Rateios[i].CustoProducao</div></td>
                                            <td class="px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"><div class="font-medium text-slate-800 dark:text-slate-100">R$ @Model.Rateios[i].ValorRateio</div></td>
                                            <td class="px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"><div class="font-medium text-slate-800 dark:text-slate-100">R$ @Model.Rateios[i].CustoProdutoTotal</div></td>
                                            <td class="px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"><div class="font-medium text-slate-800 dark:text-slate-100">R$ @Model.Rateios[i].CustoProdutoUnitario</div></td>
                                        </tr>
                                    }

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.getElementById("calcularRateio").addEventListener("click", function (event) {
        event.preventDefault();

        var form = document.getElementById("ProdutoForm");
        var newActionUrl = '@Url.Action("CalcularRateio", "Precos")';

        form.action = newActionUrl;
        form.submit();
    });
</script>


@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}